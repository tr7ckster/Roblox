local fruitTable = {}
canTP = false

for i, FruitFound in pairs(game.Workspace:GetChildren()) do
   if table.find(Fruits, FruitFound.Name) then
      table.insert(fruitTable, FruitFound.Handle.Position)
   end
end

function Hop()
  game:GetService("TeleportService"):Teleport(game.PlaceId)
end

function webhookPost(MSG)
    
msg = {
["embeds"] = {{
["color"] = 235000,
["description"] = MSG.." was found!",
["author"] = {
["name"] = "Fruit Found!"
}}
}
}

local response = syn.request(
{
Url = Webhook,
Method = "POST",
Headers = {
["Content-Type"] = "application/json"
},
Body = game:GetService("HttpService"):JSONEncode(msg)
}
)
end

function storeFruit()
    wait(1)
    print("Storeing")
    for i, Fruitpack in pairs(game.Players.LocalPlayer.Character:GetChildren()) do
       if Fruitpack.Name:match("Fruit") then
          local str = string.split(Fruitpack.Name, " ")
       
          local ohString1 = "StoreFruit"
          local ohString2 = str[1].."-"..str[1]
          fruitTable[Fruitpack] = nil;
          
          game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer(ohString1, ohString2) 
          
          webhookPost(ohString2)
          if #fruitTable == 0 and Repeat == true then
              coroutine.wrap(Hop)()
          end
       end
    end
end

CanTween = true

function tweenFruit(fruitPos, index)
   local TweenService = game:GetService("TweenService")

   local HRP = game.Players.LocalPlayer.Character.HumanoidRootPart

   local Distance = (HRP.Position - fruitPos).Magnitude
   local Time = Distance / 200
   
   local Info = TweenInfo.new(Time, Enum.EasingStyle.Sine, Enum.EasingDirection.Out, 0, false)
   local Properties = {
       CFrame = CFrame.new(fruitPos)
    }

   local Tween = TweenService:Create(HRP, Info, Properties)
   Tween:Play()
   
   Tween.Completed:Wait()
   
   CanTween = true
   
   table.remove(fruitTable, index)
   print(#fruitTable)
   if Store == true then
      if #fruitTable == 0 then
          storeFruit()
       end
   else
      if #fruitTable == 0 and Repeat == true then
         Hop() 
      end
   end
end

if #fruitTable > 0 then
   for i, getFruit in pairs(fruitTable) do
      if CanTween == true then
         tweenFruit(getFruit, i)
         CanTween = false
      end
   end 
else
    if Repeat == true then
       Hop() 
    end
end



